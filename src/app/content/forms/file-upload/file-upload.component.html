
<div class="overlay" *ngIf="loading">

  <div class="spinner ">
      <div class="spinner-grow text-primary" role="status">
          <span class="sr-only">Loading...</span>


      </div>
  </div> 
</div>
<!-- Page Header -->
<div class="dt-page__header">
  <h1 class="dt-page__title">Carga de Archivo</h1>
</div>
<!-- /page header -->

<!-- Grid -->
<div class="row">

  <!-- Grid Item -->
  <div class="col-12">

    <!-- Card -->
    

      <!-- Dropzone -->
      <div class="box-container" fxLayout="column">

        <!-- <div class="info-container">
          <p>En esta seccion podrás carcar tu archivo inicial.</p>
        </div> -->
        <form [formGroup]="loadForm"  class="needs-validation" novalidate>
        <div class="horizontal-container row">
          <div class="vertical-container col-12 col-md-4">
            <h4 class="text-muted">Selecciona una empresa</h4>

            <div class="action-container mr-5">
              <div class="btn-group mr-2 mb-2" ngbDropdown>
                <button type="button" class="btn btn-outline-primary" ngbDropdownToggle>
                  {{selectedBussines}}
                </button>
                <div ngbDropdownMenu>
                  <div *ngFor="let item of listEmpresas">
                    <a class="dropdown-item" (click)="evento(item)">{{item.nombre_comercial}}</a>
                  </div>
                  <div class="dropdown-divider"></div>
                </div>

              </div>
              <ngb-alert  [dismissible]="false" *ngIf="!id_empresa" >Campo requerido</ngb-alert>

            </div>
         

          </div>

          


          <div class="vertical-container col-12 col-md-4 d-flex flex-column align-items-stretch flex-1">
            <h4 class="text-muted">Cargar Archivo</h4>

           
              <ngx-file-drop dropZoneLabel="Drop files here" (onFileDrop)="dropped($event)"
                (onFileOver)="fileOver($event)" (onFileLeave)="fileLeave($event)">
                <ng-template ngx-file-drop-content-tmp let-openFileSelector="openFileSelector">
                  Arrastra tu archivo de excel a este recuadro o  <span>   </span> 
                <div style="padding: 20px;"></div>
                  <button type="button"   class="btn btn-outline-primary" (click)="openFileSelector()" [disabled]="disableFile">Selecciona un archivo</button>
                </ng-template>
              </ngx-file-drop>
              <div class="upload-table">
                <table class="table">
                  <thead>
                    <tr>
                      <th>Nombre: </th>
                    </tr>
                  </thead>
                  <tbody class="upload-name-style">
                    <tr *ngFor="let item of files; let i=index">
                      <td><strong>{{ item.relativePath }}</strong></td>
                    </tr>
                  </tbody>
                </table>
              </div>
              
          </div>
          <div class="vertical-container col-12 col-md-4">
            <h4 class="text-muted">Selecciona una fecha de corte</h4>
            <input type='date' #myDate min="{{currentDate|date:'yyyy-MM-dd'}}" class="form-control" formControlName="fechaCorte" required /><br>
            <br>
            <br>
            <br>
            <br>

          </div>
        </div>
        </form>
      </div>
      <!-- /dropzone -->

  
    <!-- /card -->

  </div>
  <!-- /grid item -->

</div>
<div class="row">
  <button type="button" class="btn btn-primary btn-block" [disabled]="disableSave" (click)="save()" >Guardar</button>

  <bs-card class="overflow-hidden" body-class="pt-0">
    <!-- Card Header -->
    <bs-card-header class="bg-transparent">
      <h3 class="card-title">Vista previa</h3>
    </bs-card-header>
    <!-- /card header -->

    <!-- Tables -->
    <div class="table-responsive">
      <table class="table table-bordered mb-0">
        <thead>
        <tr>
          <th scope="col">#</th>
          <th class="text-uppercase" scope="col">Nombres</th>
          <th class="text-uppercase" scope="col">Apellidos</th>
          <th class="text-uppercase" scope="col">Identificacion</th>
          <th class="text-uppercase" scope="col">Credito</th>
          <th class="text-uppercase" scope="col">Producto</th>
          <th class="text-uppercase" scope="col">Dividendo</th>
          <th class="text-uppercase" scope="col">Fecha Concesión</th>
          <th class="text-uppercase" scope="col">Fecha Vencimiento</th>
          <th class="text-uppercase" scope="col">Tasa</th>
          <th class="text-uppercase" scope="col">Plazo</th>
          <th class="text-uppercase" scope="col">Periodicidad</th>
          <th class="text-uppercase" scope="col">Monto Total</th>
          <th class="text-uppercase" scope="col">Saldo Total</th>
          <th class="text-uppercase" scope="col">Saldo Capital</th>
          <th class="text-uppercase" scope="col">Interes</th>
          <th class="text-uppercase" scope="col">Mora</th>
          <th class="text-uppercase" scope="col">Gastos Cobranza</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let user of filelist; index as i">
          <th scope="row">{{ i + 1 }}</th>
          <td>{{ user.NOMBRES }}</td>
          <td>{{ user.APELLIDOS }}</td>
          <td>{{ user.CI }}</td>
          <td>{{ user.NRO_CREDITO }}</td>
          <td>{{ user.PRODUCTO }}</td>
          <td>{{ user.NRO_DIVIDENDO }}</td>
          <td>{{ user.FECHA_CONCESION }}</td>
          <td>{{ user.FECHA_VENCIMIENTO }}</td>
          <td>{{ user.TASA }}</td>
          <td>{{ user.PLAZO }}</td>
          <td>{{ user.PERIODICIDAD }}</td>
          <td>{{ user.MONTO_TOTAL }}</td>
          <td>{{ user.SALDO_TOTAL }}</td>
          <td>{{ user.SALDO_CUOTA }}</td>
          <td>{{ user.INTERES }}</td>
          <td>{{ user.INTERES_MORA }}</td>
          <td>{{ user.GASTOS_COBRANZA}}</td>

          <td><a href="javascript:void(0)" class="btn-link">{{ user.Telefono }}</a></td>
        </tr>
        </tbody>
      </table>
    </div>
    <!-- /tables -->

  </bs-card>
</div>
<!-- /grid -->