<div class="overlay" *ngIf="loading">

    <div class="spinner ">
        <div class="spinner-grow text-primary" role="status">
            <span class="sr-only">Loading...</span>


        </div>
    </div>
</div>

<div class="mat-sidenav-container" style="overflow-y: scroll !important;">

    <div class="centersteep">

        <!-- HORIZONTAL STEPPER EXAMPLE -->
        <mat-horizontal-stepper class="mat-elevation-z4" [linear]="true">

            <mat-step [stepControl]="horizontalStepperStep1">

                <form fxLayout="column" [formGroup]="horizontalStepperStep1">

                    <ng-template matStepLabel>INGRESO DE EVENTO DE RIESGO</ng-template>

                    <div fxFlex="1 0 auto" fxLayout="column">
                        <label for="">
                            A considerar:
                        </label>
                        <p>
                            1)    En la descripción de riesgo deberá de contar con un verbo que pueda describir la acción o actividad.

                        </p>
                        <p>
                            2)    El evento debe de contemplar un sustantivo.

                        </p>
                        <p>
                            3)    El evento debe de mantener un adjetivo negativo, de ser el caso.
                        </p>
                        <br>
                        <mat-form-field appearance="outline" fxFlex="100">
                            <mat-label>Descripción del riesgo:</mat-label>



                            <input matInput formControlName="descripcionr" required>
                            <mat-error>La descripción del riesgo es requerida</mat-error>
                        </mat-form-field>



                    </div>

                    <div class="center">

                        <button mat-raised-button matStepperNext type="button" color="accent">
                            Siguiente
                        </button>
                    </div>

                </form>

            </mat-step>

            <mat-step [stepControl]="horizontalStepperStep2">

                <form fxLayout="column" [formGroup]="horizontalStepperStep2">

                    <ng-template matStepLabel>POSIBLE CAUSA</ng-template>

                    <div fxFlex="1 0 auto" fxLayout="column">
                        <label for="">
                            A considerar:
                        </label>
                        <p>
                            1) En base al evento de riesgo describir la o las posibles causas que pueden u originaron el evento de riesgo descrito.

                        </p>


                        <p>
                            2) Necesita agregar al menos una causa.

                        </p>

                        <br>
                        <div *ngFor="let field of fields">
                            <mat-form-field appearance="outline" fxFlex="100">
                                <mat-label>Posible Causa</mat-label>

                                <input matInput formControlName="{{field.id}}" required>

                                <mat-error>Debe ingresar al menos una causa</mat-error>
                            </mat-form-field>




                        </div>
                        <!-- <mat-form-field appearance="outline" fxFlex="100">
                            <mat-label>Causa #1</mat-label>

                            <input matInput formControlName="causa1" required>
                            <mat-error>Debe ingresar al menos una causa</mat-error>
                        </mat-form-field>
                        <mat-form-field appearance="outline" fxFlex="100">
                            <mat-label>Causa #2</mat-label>

                            <input matInput formControlName="causa2">

                        </mat-form-field>
                        <mat-form-field appearance="outline" fxFlex="100">
                            <mat-label>Causa #3</mat-label>

                            <input matInput formControlName="causa3">

                        </mat-form-field> -->
                        <div class="center">
                            <button mat-raised-button type="button" color="accent" (click)="agregacampo(2)">
                                +
                            </button>
                            <button mat-raised-button type="button" color="accent" (click)="deletecausa(2)">
                                -
                            </button>
                        </div>
                        <br>
                    </div>

                    <div class="center">
                        <button class="mr-8" mat-raised-button matStepperPrevious type="button" color="accent">
                            Anterior
                        </button>
                        <button mat-raised-button matStepperNext type="button" color="accent">
                            Siguiente
                        </button>
                    </div>

                </form>

            </mat-step>

            <mat-step [stepControl]="horizontalStepperStep3">

                <form fxLayout="column" [formGroup]="horizontalStepperStep3">

                    <ng-template matStepLabel>CONSECUENCIAS</ng-template>

                    <div fxFlex="1 0 auto" fxLayout="column">
                        <label for="">
                            A considerar:
                        </label>
                        <p>
                            1) Tomando como referencia el evento de riesgo, describir la consecuencia o consecuencias que en caso de materializarse el evento puede afectar a CREA.

                        </p>
                        <p>
                            2) Necesita agregar al menos una consecuencia.

                        </p>

                        <br>
                        <div *ngFor="let field of fieldscon">

                            <mat-form-field appearance="outline" fxFlex="100">
                                <mat-label>Consecuencia</mat-label>

                                <input matInput formControlName="{{field.id}}" required>

                                <mat-error>Debe ingresar al menos una consecuencia</mat-error>
                            </mat-form-field>


                        </div>



                    </div>
                    <div class="center">
                        <button mat-raised-button type="button" color="accent" (click)="agregacampo(3)">
                            +
                        </button>
                        <button mat-raised-button type="button" color="accent" (click)="deletecausa(3)">
                            -
                        </button>
                    </div>
                    <br>
                    <div class="center">
                        <button class="mr-8" mat-raised-button matStepperPrevious type="button" color="accent">
                            Anterior
                        </button>
                        <button mat-raised-button matStepperNext type="button" color="accent">
                            Siguiente
                        </button>
                    </div>

                </form>

            </mat-step>


            <mat-step [stepControl]="horizontalStepperStep4">

                <form fxLayout="column" [formGroup]="horizontalStepperStep4">

                    <ng-template matStepLabel>CALIFICAR EL EVENTO DEL RIESGO</ng-template>

                    <div fxFlex="1 0 auto" fxLayout="column">


                        <br>
                        <mat-form-field appearance="outline" fxFlex="100">
                            <mat-label>Probabilidad</mat-label>

                            <mat-select [(value)]="selected3" formControlName="probabilidad" required (selectionChange)="changeProb($event)">
                                <mat-option *ngFor="let obj of listprob" [value]="obj.idprobabilidad" [ngStyle]="{'background-color': obj.color }">
                                    {{obj.nombre}}-{{obj.descripcion}}
                                </mat-option>
                            </mat-select>
                            <span [ngStyle]="{'background-color': color1, color:color1 }" class="material-icons">
                                fiber_manual_record
                            </span>
                            <mat-error>Debe ingresar la probabilidad</mat-error>
                        </mat-form-field>
                        <mat-form-field appearance="outline" fxFlex="100">
                            <mat-label>Impacto</mat-label>

                            <mat-select [(value)]="selected4" formControlName="impacto" required #tooltip="matTooltip" matTooltip="Info about the action" (selectionChange)="changeImpacto($event)">
                                <mat-option *ngFor="let obj of listImpacto" [value]="obj.idimpacto" [ngStyle]="{'background-color': obj.colors } ">
                                    {{obj.nombre}} -{{obj.descripcion}}
                                </mat-option>
                            </mat-select>
                            <span [ngStyle]="{'background-color': color2, color:color2 }" class="material-icons">
                                fiber_manual_record
                            </span>
                            <mat-error>Debe ingresar el impacto</mat-error>
                        </mat-form-field>
                        <mat-form-field appearance="outline" fxFlex="100">
                            <mat-label>Riesgo inherente o riesgo puro</mat-label>

                            <mat-select [(value)]="selected5" formCon trolName="riesgoin" disabled (selectionChange)="changeRiesgo($event)">
                                <mat-option *ngFor="let obj of listriesgoin" [value]="obj.idriesgoinherente" [ngStyle]="{'background-color': obj.color }">
                                    {{obj.nombre}}
                                </mat-option>
                            </mat-select>
                            <span [ngStyle]="{'background-color': color3, color:color3 }" class="material-icons">
                                fiber_manual_record
                            </span>
                            <mat-error>Debe ingresar la probabilidad</mat-error>
                        </mat-form-field>

                    </div>

                    <div class="center">
                        <button class="mr-8" mat-raised-button matStepperPrevious type="button" color="accent">
                            Anterior
                        </button>
                        <button mat-raised-button matStepperNext type="button" color="accent" (click)="cargadatos()">
                            Siguiente
                        </button>
                    </div>

                </form>

            </mat-step>


            <mat-step>
                <form fxLayout="column" [formGroup]="horizontalStepperStep5">
                    <ng-template matStepLabel>FINALIZAR</ng-template>
                    <div class="h2 m-16" fxLayout="row" fxLayoutAlign="center ">
                        <h1 style="align-items: center;"> Resumen del Riesgo</h1>
                    </div>
                    <label class="etiquetas">
                        Descripción:
                    </label>
                    <p>
                        {{descripcion}}.

                    </p>
                    <label class="etiquetas">
                        Posibles Causas
                    </label>
                    <div *ngFor="let field of listcausas">
                        <p>
                            {{field}}

                        </p>
                    </div>
                    <label class="etiquetas">
                        Posibles Consecuencias
                    </label>
                    <div *ngFor="let field of listconsec">
                        <p>
                            {{field}}

                        </p>
                    </div>
                    <label class="etiquetas">
                        Probabilidad impacto y riesgo
                    </label>
                    <p>
                        <span [ngStyle]="{'background-color': color1, color:color1 }" class="material-icons">
                            fiber_manual_record
                        </span>
                        <span [ngStyle]="{'background-color': color2, color:color2 }" class="material-icons">
                            fiber_manual_record
                        </span>
                        <span [ngStyle]="{'background-color': color3, color:color3 }" class="material-icons">
                            fiber_manual_record
                        </span>
                    </p>
                    <label class="etiquetas">
                        ¿Considera alguna oportunidad de mejora?
                    </label>
                    <mat-radio-group name="opciones">
                        <mat-radio-button required (change)="radioChange($event)" *ngFor="let op of esriesgo" name="opciones" [value]="op.val" style="margin: 10px">
                            {{op.des}}
                        </mat-radio-button>
                    </mat-radio-group>
                    <label class="etiquetas">
                        ¿Es un riesgo de Seguridad de la Información?
                    </label>
                    <mat-radio-group name="opciones_2">
                        <mat-radio-button required (change)="radioChange2($event)" *ngFor="let ope of seguridadinfo" name="opciones_2" [value]="ope.val" style="margin: 10px">
                            {{ope.des}}
                        </mat-radio-button>
                    </mat-radio-group>



                    <mat-form-field appearance="outline" fxFlex="100" *ngIf="muestraob">
                        <mat-label>Observaciones</mat-label>
                        <textarea matInput formControlName="observaciones" required placeholder="Ejemplo: ......"></textarea>
                    </mat-form-field>
                    <div class="center">
                        <button class="mr-8" mat-raised-button matStepperPrevious type="button" color="accent">
                            Anterior
                        </button>
                        <button mat-raised-button type="button" color="accent" (click)="finishHorizontalStepper()">
                            Guardar
                        </button>
                    </div>
                </form>
            </mat-step>

        </mat-horizontal-stepper>


    </div>